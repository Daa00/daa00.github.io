<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Majors Filter</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.1.2/handlebars.min.js"></script>
</head>
<body>
<h1>Select a Major</h1>
<button id="citBtn">CIT Majors</button>
<button id="busBtn">Business Majors</button>
<h2>We filter our dataset by major</h2>
<div id="result"></div>
<script id="text-template" type="text/x-handlebars-template">
<table>
  <thead>
    <tr><th>Name</th><th>Major</th><th>Midterm</th><th>Final</th></tr>
  </thead>
  <tbody>
  {{#each students}}
  <tr>
     <td>{{name}}</td>
     <td>{{major}}</td>
    <td>{{midterm}}</td>
     <td>{{final}}</td>
    </tr>
    {{/each}}
  </tbody>
</table>
</script>

<script>
let studentsData = [];

fetch('cit5students.json')
  .then(r => r.json())
  .then(d => {
    studentsData = d;
    show_students("CIT");
  });

function show_students(major) {
  let filtered = studentsData.filter(s => s.major === major);
  let context = { students: filtered };

  let source = document.getElementById('text-template').innerHTML;
  let template = Handlebars.compile(source);
  let html = template(context);

  document.getElementById('result').innerHTML = html;
}

document.getElementById('citBtn').addEventListener('click', () => show_students("CIT"));
document.getElementById('busBtn').addEventListener('click', () => show_students("BUS"));
</script>

</body>
</html>
